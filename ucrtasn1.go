package main

import (
	"crypto/x509"
	// "encoding/asn1"
	// "encoding/hex"
	"encoding/pem"
	"fmt"
)

func main() {
	// hexbytes, err := hex.DecodeString("31820116FF8492BDA4440B30091604424F5244020106FF849AA192500C300A16044348495002027000FF84AA8D924411300F1604454349440207121D8C18A34DBAFF8693B5C2631B30191604626D6163041164303A33333A31313A30363A31363A3934FF86CBB5CA691930171604696D6569040F333539333034303636353531363637FF86EB95D26418301616046D656964040E3335393330343036363535313636FF879BC9DC6D163014160473726E6D040C4631445135314B5547354D43FF87AB91D264323030160475646964042862633635646535656434316665333865653330313638323837656432326434303363353462343864FF87BBB5C2631B30191604776D6163041164303A33333A31313A30363A31363A3933")
	// if err != nil {
	// 	fmt.Println("hex decode err:%s", err.Error())
	// }
	p := `-----BEGIN CERTIFICATE-----
MIIDaDCCAw6gAwIBAgIGAZjGqy4wMAoGCCqGSM49BAMCMEUxEzARBgNVBAgMCkNh
bGlmb3JuaWExEzARBgNVBAoMCkFwcGxlIEluYy4xGTAXBgNVBAMMEEZEUkRDLVVD
UlQtU1VCQ0EwHhcNMjUwODIwMDgzOTI0WhcNMjUwODI3MDg0OTI0WjBuMRMwEQYD
VQQIDApDYWxpZm9ybmlhMRMwEQYDVQQKDApBcHBsZSBJbmMuMR4wHAYDVQQLDBV1
Y3J0IExlYWYgQ2VydGlmaWNhdGUxIjAgBgNVBAMMGTAwMDA3MDAwLTAwMTkyMDI0
MThCODE0MjYwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAATlu6CRPV9XmcV7du5K
kfn8qsVz8RAk4Auxhcj+czd4zNR37u/RHYcC9aY2u4YKTmKyFLTh3FQ4ci9SkBID
w4Kxo4IBvzCCAbswDAYDVR0TAQH/BAIwADAOBgNVHQ8BAf8EBAMCBPAwggEpBgkq
hkiG92NkCgEEggEaMYIBFv+Ekr2kRAswCRYEQk9SRAIBBv+EmqGSUAwwChYEQ0hJ
UAICcAD/hKqNkkQRMA8WBEVDSUQCBxkgJBi4FCb/hpO1wmMbMBkWBGJtYWMEETcw
OmVjOmU0OjRlOjE4OmNl/4bLtcppGTAXFgRpbWVpBA8zNTkzMTEwNjgwODg3MTP/
huuV0mQYMBYWBG1laWQEDjM1OTMxMTA2ODA4ODcx/4ebydxtFjAUFgRzcm5tBAxE
TlBRMkhTWEc1TVH/h6uR0mQyMDAWBHVkaWQEKDVhZTI4ODhjZDkyYzU1ZTRjODNj
Mzg0MGQwMGI3MmJlNWI5NWQxOWX/h7u1wmMbMBkWBHdtYWMEETcwOmVjOmU0OjRl
OjE4OmNkMDIGCiqGSIb3Y2QGAQ8EJDEi/4TqhZxQCjAIFgRNQU5QMQD/hPqJlFAK
MAgWBE9CSlAxADASBgkqhkiG92NkCgIEBTADAgEAMCYGCSqGSIb3Y2QIBwQZMBe/
ingIBAYxMi41Lje/insHBAUxNkg4MTAKBggqhkjOPQQDAgNIADBFAiEAuQzguHH4
+wtZrlRkKqy8XrvWnq0TP06l9OCUejmrdccCIGKWzWN3VBwFniQXrMnJ0yy+H3ZK
HTmoLdag85vVOjfG
-----END CERTIFICATE-----`
	pemblock, _ := pem.Decode([]byte(p))
	if pemblock == nil {
		fmt.Println("Failed to parse PEM block")
		return
	}
	cert, err := x509.ParseCertificate(pemblock.Bytes)
	if err != nil {
		fmt.Println("Failed to parse certificate:", err)
		return
	}

	// Print the subject details
	fmt.Println("Subject:%+v", cert.Extensions)

}
